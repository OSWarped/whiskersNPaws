(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{9306:(e,t,r)=>{Promise.resolve().then(r.bind(r,8013))},8013:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(5155),a=r(2115),o=r(8998),n=r(9561),i=r(1396),c=r(4918),l=r(1983),d=r(4156),h=r(2282),u=r(3691),x=r.n(u);function j(){let[e,t]=(0,a.useState)([]),[r,u]=(0,a.useState)([]),[j,y]=(0,a.useState)(""),[g,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t(JSON.parse(localStorage.getItem("bookings")||"[]")),(async()=>{try{let e=localStorage.getItem("jwt");if(!e){console.error("No JWT found. Please log in.");return}let t=await fetch("/api/pets/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();u(e)}else console.error("Failed to fetch pets:",await t.json())}catch(e){console.error("Error fetching pets:",e)}})()},[]);let v=e=>e?e.map(e=>{var t;return(null===(t=r.find(t=>t.id===e))||void 0===t?void 0:t.name)||"Pet ID: ".concat(e)}).join(", "):"No pets selected",A=async()=>{p(!0),y(""),m("");try{let r=localStorage.getItem("jwt");if(!r){m("User is not logged in."),p(!1);return}let s=await fetch("/api/reservations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({bookings:e})});if(s.ok)y("Reservations successfully created!"),localStorage.removeItem("bookings"),t([]);else{let e=await s.json();m(e.message||"Failed to create reservations.")}}catch(e){console.error("Error creating reservations:",e),m("An unexpected error occurred. Please try again.")}finally{p(!1)}};return(0,s.jsxs)(o.A,{sx:{p:4,maxWidth:800,mx:"auto"},children:[(0,s.jsx)(n.A,{variant:"h4",gutterBottom:!0,children:"Checkout"}),j&&(0,s.jsx)(i.A,{severity:"success",sx:{mb:2},children:j}),g&&(0,s.jsx)(i.A,{severity:"error",sx:{mb:2},children:g}),(0,s.jsx)(c.A,{children:e.map((e,t)=>(0,s.jsxs)(o.A,{children:[(0,s.jsx)(l.Ay,{children:(0,s.jsx)(n.A,{variant:"body1",children:(0,s.jsx)("strong",{children:e.title})})}),(0,s.jsx)(l.Ay,{children:(0,s.jsxs)(n.A,{variant:"body2",children:["Date: ",x()(e.start).format("MM/DD/YYYY")]})}),(0,s.jsx)(l.Ay,{children:(0,s.jsxs)(n.A,{variant:"body2",children:["Pets: ",v(e.petIds)]})}),(0,s.jsx)(l.Ay,{children:(0,s.jsxs)(n.A,{variant:"body2",children:["Total Cost: $",e.totalCost.toFixed(2)]})}),(0,s.jsx)(d.A,{})]},t))}),(0,s.jsx)(h.A,{variant:"contained",color:"primary",sx:{mt:4},onClick:A,disabled:f||0===e.length,children:f?"Processing...":"Mock Payment"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[586,380,282,269,626,905,441,517,358],()=>t(9306)),_N_E=e.O()}]);